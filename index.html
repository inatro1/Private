<meta name='viewport' content='width=device-width, initial-scale=1'/><!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INATRO • Portal</title>
   
          <script>
    if(localStorage.getItem('loggedIn') !== 'true'){
        window.location.href = "login.html";
    }
</script>

    <!-- CSS externo -->
    <link rel="stylesheet" href="styles.css">

    <!-- Ícones -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>

    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="brand">INATRO</div>

        <div class="menu-item active">
            <i class="fa fa-users"></i> Resultados
        </div>
        <div class="menu-item">
            <i class="fa fa-chart-bar"></i> Candidatos
        </div>
        <div class="menu-item">
            <i class="fa fa-clock"></i> Exames em Realização
        </div>

        <div class="menu-item logout">
            <i class="fa fa-sign-out-alt"></i> Sair
        </div>
    </aside>

    <!-- Conteúdo -->
    <main class="content">

        <header>
            <h1>Resultados</h1>

            <div class="controls">
                <input type="text" id="search" class="search" placeholder="Pesquisar nome...">

                <button class="filter-btn" onclick="filtrar('Aprovado')">Aprovados</button>
                <button class="filter-btn" onclick="filtrar('Reprovado')">Reprovados</button>
                <button class="filter-btn" onclick="filtrar('Fraude')">Fraude</button>
                <button class="filter-btn" oneclik="filtrar('Publico')">Publico</button>
                <button class="filter-btn" onclick="resetFiltros()">Todos</button>
            </div>
        </header>

        <!-- Subtítulo e Usuário -->
        <div class="portal-subtitulo">Portal do Funcionário</div>
        <div class="usuario-titulo">Usuário: Mateus da Maria José</div>

        <!-- Tabela -->
        <div class="table-wrap">
            <table id="tabela">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Nome</th>
                        <th>Nº Candidato</th>
                        <th>Delegação</th>
                        <th>Data</th>
                        <th>Hora Início</th>
                        <th>Hora Fim</th>
                        <th>Pontos</th>
                        <th>Estado</th>
                        <th>Fraude</th>
                        <th>Público</th>
                    </tr>
                </thead>

                <tbody>
                    <tr>
                        <td>1</td>
                        <td>Diogo Magalhas Maricoua</td>
                        <td>A1180380525</td>
                        <td>Nampula</td>
                        <td>2025-08-20</td>
                        <td>12:32:14</td>
                        <td>12:53:29</td>
                        <td>13</td>
                        <td><span class="status reprovado">Reprovado</span></td>
                        <td><span class<="status fraude">Fraude</span></td>
                        <td><span class<="status fraude">Público</span></td>
                        
                    </tr>

                    <tr>
                        <td>2</td>
                        <td>Diogo Magalhas Maricoua</td>
                        <td>A1180380525</td>
                        <td>Nampula</td>
                        <td>2025-11-05</td>
                        <td>12:38:46</td>
                        <td>12:49:09</td>
                        <td>21</td>
                        <td><span class="status aprovado">Aprovado</span></td>
                        <td><span class="status publicação">Não publicado</span></td>
                        <td><span class<="status fraude">Não Público</span></td>
                    </tr>   
                    
    <tr>
        <td>1</td>
        <td>Feliz Manuel</td>
        <td>A1110260325</td>
        <td>Nampula</td>
        <td>2025-05-27</td>
        <td>12:32:14</td>
        <td>12:53:29</td>
        <td>13</td>
        <td><span class="status reprovado">Reprovado</span></td>
        <td><span class="status fraude">Fraude</span></td>
        <td><span class<="status fraude">Não Público</span></td>
    </tr>

    <tr>
        <td>2</td>
        <td>Neldo Joaquim Jaime</td>
        <td>A1110890624</td>
        <td>Nampula</td>
        <td>2025-11-05</td>
        <td>12:38:46</td>
        <td>12:49:09</td>
        <td>21</td>
        <td><span class="status aprovado">Aprovado</span></td>
        <td><span class="status fraude">Fraude</span></td>
        <td><span class<="status fraude">Não Público</span></td>
    </tr>

    <tr>
        <td>3</td>
        <td>Alberto Tomás</td>
        <td>A1140700231</td>
        <td>Nampula</td>
        <td>2025-05-28</td>
        <td>10:11:05</td>
        <td>10:32:40</td>
        <td>14</td>
        <td><span class="status reprovado">Reprovado</span></td>
        <td><span class<="status fraude">Não Público</span></td>
        <td></td>
    </tr>

    <tr>
        <td>4</td>
        <td>Aisha Ussene</td>
        <td>A1170934211</td>
        <td>Nampula</td>
        <td>2025-05-28</td>
        <td>09:21:10</td>
        <td>09:41:50</td>
        <td>22</td>
        <td><span class="status aprovado">Aprovado</span></td>
        <td><span class<="status fraude">Não Público</span></td>
        <td></td>
    </tr>

    <tr>
        <td>5</td>
        <td>Júlio Matavel</td>
        <td>A1180209851</td>
        <td>Nampula</td>
        <td>2025-05-28</td>
        <td>08:41:32</td>
        <td>09:01:28</td>
        <td>10</td>
        <td><span class="status reprovado">Reprovado</span></td>
        <td><span class<="status fraude">Não Público</span></td>
        <td></td>
    </tr>

    <tr>
        <td>6</td>
        <td>Carina João</td>
        <td>A1120965423</td>
        <td>Nampula</td>
        <td>2025-05-28</td>
        <td>13:12:40</td>
        <td>13:33:22</td>
        <td>24</td>
        <td><span class="status aprovado">Aprovado</span></td>
        <td><span class<="status fraude">Não Público</span></td>
        <td></td>
    </tr>

    <tr>
        <td>7</td>
        <td>Ernesto Lisboa</td>
        <td>A1170667810</td>
        <td>Nampula</td>
        <td>2025-05-28</td>
        <td>14:20:59</td>
        <td>14:41:18</td>
        <td>12</td>
        <td><span class="status reprovado">Reprovado</span></td>
        <td><span class<="status fraude">Não Público</span></td>
        <td></td>
    </tr>

    <tr>
        <td>8</td>
        <td>Yara Juvêncio</td>
        <td>A1130456123</td>
        <td>Nacala</td>
        <td>2025-05-28</td>
        <td>10:15:11</td>
        <td>10:35:14</td>
        <td>23</td>
        <td><span class="status aprovado">Aprovado</span></td>
        <td><span class<="status fraude">Não Público</span></td>
        <td></td>
    </tr>

    <tr>
        <td>9</td>
        <td>Mauro Tchapo</td>
        <td>A1190321458</td>
        <td>Inhambane</td>
        <td>2025-05-28</td>
        <td>11:01:25</td>
        <td>11:21:33</td>
        <td>0</td>
        <td><span class="status fraude">Fraude</span></td>
        <td><span class="status fraude">Fraude</span></td>
    </tr>

    <tr>
        <td>10</td>
        <td>Samira Chongo</td>
        <td>A1130987120</td>
        <td>Pemba</td>
        <td>2025-05-28</td>
        <td>09:55:09</td>
        <td>10:14:28</td>
        <td>25</td>
        <td><span class="status aprovado">Aprovado</span></td>
        <td><span class<="status fraude">Não Público</span></td>
        <td></td>
    </tr>
            </tbody>

                </tbody>
            </table>
        </div>

    </main>

    <!-- Script externo -->
    <script src="script.js"></script>
</body>
</html><style>:root {
    --green: #006b3f;
    --lightgreen: #e6fff0;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: Arial, sans-serif;
}

body {
    background: #f5f5f5;
    display: flex;
}

.sidebar {
    width: 220px;
    height: 100vh;
    background: var(--green);
    color: #fff;
    padding: 20px;
}

.brand {
    text-align: center;
    font-size: 22px;
    margin-bottom: 30px;
    font-weight: bold;
}

.menu-item {
    padding: 12px;
    border-radius: 8px;
    cursor: pointer;
    margin-bottom: 10px;
}

.menu-item:hover,
.menu-item.active {
    background: rgba(255, 255, 255, 0.2);
}

.content {
    flex: 1;
    padding: 20px;
}

header {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

h1 {
    color: var(--green);
}

.controls {
    display: flex;
    gap: 10px;
}

.search {
    padding: 8px 12px;
    border: 1px solid #ccc;
    border-radius: 8px;
}

.filter-btn {
    padding: 8px 12px;
    border: 1px solid #ccc;
    background: white;
    border-radius: 6px;
    cursor: pointer;
}

.table-wrap {
    margin-top: 20px;
    background: white;
    padding: 10px;
    border-radius: 10px;
    overflow-x: auto;
}

table {
    width: 100%;
    border-collapse: collapse;
}

th {
    padding: 12px;
    background: var(--lightgreen);
    text-align: left;
}

td {
    padding: 10px;
    border-bottom: 1px solid #eee;
}

.status {
    padding: 6px 10px;
    color: white;
    border-radius: 6px;
    font-size: 13px;
    font-weight: bold;
}

.aprovado { background: #009432; }
.reprovado { background: #ea2027; }
.fraude { background: #d63031; }</style><script>// server.js
const express = require("express");
const cors = require("cors");
const bodyParser = require("body-parser");
const mysql = require("mysql2/promise");
const bcrypt = require("bcrypt");
const jwt = require("jsonwebtoken");

const app = express();
app.use(cors());
app.use(bodyParser.json());

const PORT = 3000;
const JWT_SECRET = "troque_isto_para_um_seguro_secret";

// Configure a conexão MySQL
const pool = mysql.createPool({
  host: "localhost",
  user: "seu_user",
  password: "sua_senha",
  database: "inatro_db",
  waitForConnections: true,
  connectionLimit: 10,
  queueLimit: 0
});

// Login (POST /api/login) -> return token + user
app.post("/api/login", async (req, res) => {
  const { username, password } = req.body;
  try {
    const [rows] = await pool.query("SELECT id, username, password_hash, role FROM users WHERE username = ?", [username]);
    if (!rows.length) return res.status(401).json({ error: "Credenciais inválidas" });
    const user = rows[0];
    const ok = await bcrypt.compare(password, user.password_hash);
    if (!ok) return res.status(401).json({ error: "Credenciais inválidas" });
    const token = jwt.sign({ id: user.id, username: user.username, role: user.role }, JWT_SECRET, { expiresIn: "8h" });
    res.json({ token, user: { id: user.id, username: user.username, role: user.role } });
  } catch (err) {
    console.error(err); res.status(500).json({ error: "erro no servidor" });
  }
});

// middleware simples (valida token)
function auth(req, res, next){
  const authHeader = req.headers.authorization;
  if(!authHeader) return res.status(401).json({error:"Sem autorização"});
  const token = authHeader.split(" ")[1];
  try{
    const data = jwt.verify(token, JWT_SECRET);
    req.user = data;
    next();
  }catch(e){ return res.status(401).json({error:"Token inválido"}); }
}

// GET candidates
app.get("/api/candidates", auth, async (req,res)=>{
  try{
    const [rows] = await pool.query("SELECT id,name,code,delegation AS deleg, `date`, ingresso as `in`, saida as `out`, points AS pts, status, fraude FROM candidates ORDER BY id ASC");
    res.json(rows);
  }catch(err){ console.error(err); res.status(500).json({error:"db"}); }
});

// PUT update candidate (id)
app.put("/api/candidates/:id", auth, async (req,res)=>{
  const id = Number(req.params.id);
  const body = req.body;
  try{
    await pool.query("UPDATE candidates SET name=?, status=?, fraude=?, points=? WHERE id=?", [body.name, body.status, body.fraude?1:0, body.pts || 0, id]);
    res.json({ok:true});
  }catch(err){ console.error(err); res.status(500).json({error:"db update"}); }
});

app.listen(PORT, ()=> console.log("API running on http://localhost:" + PORT));</script>
